<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lista de la compra">
    <meta name="keywords" content="HTML, CSS, JavaScript">
    <meta name="author" content="Beatriz R.">
    <title>Lista de la compra</title>
    <!-- <link rel="stylesheet" href="styles.css">
    <script defer src="script.js"></script> -->
</head>

<body>
    <div id="usuario-info">
        <span>Usuario: <span id="nombre-usuario">Cargando...</span></span>
        <button id="cerrar-sesion">Cerrar sesión</button>
    </div>

    <div id="contenedor">
        <h1>Lista de la compra:</h1>
    </div>

    <button type="button" id="add">Añadir artículo</button>
    <div id="mostrar-lista">

    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            verficarSesion();

            document.getElementById('cerrar-sesion').addEventListener('click',cerrarSesion);
        });

        function verficarSesion(){

            fetch('verificar-sesion.php')
            .then(response=>{
                if(!response.ok){
                    throw new Error('Error en la respuesta del servidor');
                }
                return response.json();
            })
            .then(data=>{
                console.log('Respuesta de verificación: ', data);

                if(!data.autenticado){
                    alert('Debes iniciar sesión para acceder a tu lista de la compra');
                    window.location.href='index.html';
                    return;
                }
                document.getElementById('nombre-usuario').textContent=data.usuario;

                window.usuarioEmail=data.email;
                //
            })
            .catch(error=>{
                console.error('Error verificando la sesión:', error);
                    alert('Error al verificar la sesión. Serás redirigido al login.');
                    window.location.href = 'index.html';
            })
        }

    </script>
</body>

</html>